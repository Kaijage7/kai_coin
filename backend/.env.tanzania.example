# ==============================================
# ðŸ‡¹ðŸ‡¿ TANZANIA M-PESA CONFIGURATION
# ==============================================
# Copy this to .env and fill in your credentials

# Environment: 'sandbox' for testing, 'production' for real money
MPESA_ENVIRONMENT=sandbox

# ==============================================
# VODACOM M-PESA API CREDENTIALS
# ==============================================
# Get these from: https://developer.mpesa.vm.co.tz/

# Sandbox credentials (for testing - no real money)
MPESA_API_KEY=your_sandbox_api_key_here
MPESA_PUBLIC_KEY=your_sandbox_public_key_here
MPESA_SERVICE_PROVIDER_CODE=000000

# Production credentials (for real money - get after testing)
# MPESA_API_KEY=your_production_api_key_here
# MPESA_PUBLIC_KEY=your_production_public_key_here
# MPESA_SERVICE_PROVIDER_CODE=your_business_number

# ==============================================
# CALLBACK CONFIGURATION
# ==============================================

# Your public API URL (for M-Pesa callbacks)
# For local testing, use ngrok: https://abc123.ngrok.io
# For production: https://api.kaicoin.io
API_URL=http://localhost:3333

# ==============================================
# CURRENCY & PRICING
# ==============================================

# Tanzania
DEFAULT_CURRENCY=TZS
TZS_EXCHANGE_RATE=2300  # 1 USD = 2,300 TZS (update as needed)

# ==============================================
# DATABASE CONFIGURATION
# ==============================================

DATABASE_URL=postgresql://user:password@localhost:5432/kai_tanzania
REDIS_URL=redis://localhost:6379

# ==============================================
# BLOCKCHAIN CONFIGURATION (Optional)
# ==============================================

# For smart contract integration (if needed later)
BLOCKCHAIN_RPC=https://polygon-amoy.g.alchemy.com/v2/your-key
KAI_TOKEN_ADDRESS=

# ==============================================
# TESTING CONFIGURATION
# ==============================================

# Your real Vodacom number for testing (format: 255712345678)
TEST_PHONE_NUMBER=255712345678

# Test amounts (in TZS)
TEST_SMALL_AMOUNT=1000    # ~$0.43 for initial testing
TEST_ALERT_AMOUNT=46000   # ~$20 for flood alert

# ==============================================
# HOW TO GET STARTED
# ==============================================

# STEP 1: Get Sandbox Credentials
# 1. Visit https://developer.mpesa.vm.co.tz/
# 2. Sign up for free account
# 3. Go to "My Apps" â†’ Create App
# 4. Copy API Key and Public Key
# 5. Paste above in MPESA_API_KEY and MPESA_PUBLIC_KEY

# STEP 2: Test in Sandbox
# 1. Copy this file to .env:
#    cp .env.tanzania.example .env
# 2. Fill in your sandbox credentials
# 3. Run test:
#    cd backend
#    npm install
#    node test-tanzania-payment.js

# STEP 3: Get Production Credentials
# 1. Visit Vodacom shop with business documents
# 2. Apply for "M-Pesa for Business" account
# 3. Get production API credentials
# 4. Update .env with production keys
# 5. Set MPESA_ENVIRONMENT=production

# STEP 4: Test with Real Money (Small Amount)
# 1. Make sure MPESA_ENVIRONMENT=production
# 2. Update TEST_PHONE_NUMBER with your number
# 3. Run: node test-tanzania-payment.js --real
# 4. Check your phone for M-Pesa prompt
# 5. Enter PIN to confirm
# 6. Verify money received in business account

# STEP 5: Launch to Customers!
# 1. Start backend server: npm start
# 2. Share payment link with customers
# 3. Start collecting revenue! ðŸ’°

# ==============================================
# SUPPORT
# ==============================================

# Vodacom M-Pesa Support: 0753 000 000
# Developer Portal: https://developer.mpesa.vm.co.tz/
# Documentation: https://developer.mpesa.vm.co.tz/apis/

# ==============================================
# COMMON ISSUES
# ==============================================

# Issue: "Invalid API Key"
# Solution: Make sure you're using sandbox key in sandbox mode,
#          production key in production mode

# Issue: "Customer not receiving prompt"
# Solution: Verify phone number format (255712345678)
#          Ensure customer has Vodacom (not Tigo/Airtel)

# Issue: "INS-2001 Insufficient Balance"
# Solution: Customer needs to add money to M-Pesa
#          Ask them to dial *150*00# to check balance

# Issue: "Callback not received"
# Solution: Make sure API_URL is publicly accessible
#          Use ngrok for local testing
#          Check ngrok dashboard at http://127.0.0.1:4040
